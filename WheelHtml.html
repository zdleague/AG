<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Vertical Wheel from Google Sheets</title>
  <style>
    body {
      background-color: #000;
      color: #fff;
      margin: 0;
      overflow: hidden;
      font-family: sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    #wheel-container {
      border: 4px solid white;
      width: 300px;
      height: 150px;
      overflow: hidden;
      position: relative;
    }
  #wheel {
      position: absolute;
      width: 100%;
      transition: transform 4s cubic-bezier(0.2, 0.8, 0.2, 1);
    }
    .item {
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-bottom: 1px solid #444;
      background: #222;
    }
    .indicator {
      position: absolute;
      top: 120px;
      left: 0;
      width: 100%;
      text-align: center;
      font-size: 2em;
      color: red;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <div class="indicator">â–¼</div>
  <div id="wheel-container">
    <div id="wheel"></div>
  </div>

  <script>
    const wheel = document.getElementById('wheel');
    let options = [];

    const sheetURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQs-Szpo_J6BXehkgdXROIt99TcipqnMHCizMdkpMJ2-Ag2mY_C_n1j2Ij-OekVbLTrmarwt4m6b-6p/pub?output=csv';

    async function loadOptionsFromSheet() {
      try {
        const res = await fetch(sheetURL);
        const text = await res.text();
        options = text
          .split('\n')
          .map(line => line.trim())
          .filter(line => line.length > 0);
        buildWheel();
      } catch (err) {
        console.error("Error loading Google Sheet:", err);
        options = ["Error loading sheet"];
        buildWheel();
      }
    }

    function buildWheel() {
      wheel.innerHTML = '';
      options.forEach(option => {
        const div = document.createElement('div');
        div.className = 'item';
        div.textContent = option;
        wheel.appendChild(div);
      });
    }
//This is where Im having a problem and may need to replace with the OG code which is in backup
 function spinWheel() {
      if (options.length === 0) return;
      const randomIndex = Math.floor(Math.random() * options.length);
      const offset = 60 * randomIndex;
      wheel.style.transition = "transform 6s cubic-bezier(0.25, 1, 0.5, 1)";
      wheel.style.transform = `translateY(-500px)`;
    }

    // Trigger from Mix It Up
    window.addEventListener("message", (event) => {
      if (event.data === "spin") {
        spinWheel();
      }
    });

    // Optional: click to test
    document.body.addEventListener("click", spinWheel);

    loadOptionsFromSheet();
  </script>
</body>
</html>
